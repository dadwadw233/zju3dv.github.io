<!DOCTYPE html>

<html lang="en">

<head>
  <meta content="Generating Human Motion in 3D Scenes from Text Descriptions" name="title" />
  <meta content="" name="description" />
  <meta content="" name="keywords" />
  <meta content="index, follow" name="robots" />
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
  <meta content="English" name="language" />
  <meta content="Zhi Cen" name="author" />
  <title>Generating Human Motion in 3D Scenes from Text Descriptions</title>
  <!-- Bootstrap -->
  <script src="js/video_comparison.js"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/bootstrap-4.4.1.js"></script>

  <link href="css/bootstrap-4.4.1.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;700;800;900&amp;display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" rel="stylesheet" />

  <script src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js"></script>

  <style>
    code {
      white-space: pre-wrap;
    }

    body {
      font-family: 'Jost';
    }

    b {
      font-weight: black;
    }

    strong {
      font-weight: bold;
    }

    section>h5 {
      padding-bottom: 30px;
    }

    .col-12>h3 {
      padding-top: 30px;
    }

    .results-section {
      padding-bottom: 30px;
    }

    .carousel-control-prev,
    .carousel-control-next {
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
    }

    .carousel-control-prev {
      left: 25px;
    }

    .carousel-control-next {
      right: 25px;
    }

    .carousel-indicators {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      bottom: 0%;
      left: 90%;

      /* Adjust vertical position */
      text-align: center;
      /* Center the content horizontally */
      margin: 0;
      padding: 0;
      list-style: none;
    }

    .carousel-indicators li {
      background-color: transparent;
      /* Hide the default Bootstrap indicators */
      border: none;
      /* Remove border */
      margin: 0 25px;
      display: inline-block;
    }

    .indicator-dot {
      display: inline-block;
      width: 15px;
      height: 15px;
      text-indent: -999px;
      border: none;
      border-radius: 10px;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .row.sm-gutters {
      margin-right: 5px;
      margin-left: 5px;
      margin-top: 5px;
      margin-bottom: 5px;
    }

    .row.sm-gutters>.col-md-4 {
      padding-right: 5px;
      padding-left: 5px;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .row.sm-gutters>.col-md-6 {
      padding-right: 5px;
      padding-left: 5px;
      padding-top: 5px;
      padding-bottom: 5px;
    }

    .row.sm-gutters>.col-md-12 {
      padding-top: 5px;
      padding-bottom: 5px;
      padding-right: 5px;
      padding-left: 5px;
    }

    .renbody-zoom-container {
      width: 80%;
      /* Or whatever size you want */
      aspect-ratio: 0.75;
      /* Or whatever size you want */
      overflow: hidden;
      /* Hide the parts of the video outside the container */
      object-fit: cover;
      /* Make sure the video covers the container without stretching */
      object-position: center;
      /* Center the video */
      border-radius: 5px;
    }

    .mobile-zoom-container {
      width: 100%;
      /* Or whatever size you want */
      aspect-ratio: 0.75;
      /* Or whatever size you want */
      overflow: hidden;
      /* Hide the parts of the video outside the container */
      object-fit: cover;
      /* Make sure the video covers the container without stretching */
      object-position: center;
      /* Center the video */
      border-radius: 5px;
      margin: 5px
    }

    .video-zoom-container {
      overflow: hidden;
      /* Hide the parts of the video outside the container */
      object-fit: cover;
      /* Make sure the video covers the container without stretching */
      object-position: center;
      border-radius: 5px;
      margin: 5px;
    }

    .zoom-element {
      transition: transform 0.2s ease-in-out;
    }

    .zoom-element:hover {
      transform: scale(1.65);
    }

    .nhr-zoom {
      transform: scale(1.45);
    }

    .renbody-zoom {
      transform: scale(1.65) translateY(2%);
      border-radius: 5px;
    }

    .mobile-zoom {
      transform: scale(1.65);
      border-radius: 5px;
    }

    .zjumocap-zoom {
      transform: scale(1.3);
    }

    video {
      border-radius: 5px;
      padding: 0px;
      margin: 0px;
    }

    .comparison-canvas {
      padding: 0px;
      margin: 0px;
      border-radius: 5px;
    }

    .a16x9 {
      aspect-ratio: 16/9;
    }

    .a4x3 {
      aspect-ratio: 1352/1014;
    }

    .a1x1 {
      aspect-ratio: 1;
    }

    .a16x9demo {
      aspect-ratio: 1920/1152;
    }

    .a4x3demo {
      aspect-ratio: 1352/1086;
    }

    .a1x1demo {
      aspect-ratio: 1600/1672;
    }
  </style>
  <script>



  </script>
  </link>
</head>

<body>
  <!-- cover -->
  <section>
    <div class="jumbotron text-center mt-0">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h1 style="font-weight: bold">
              <b>
                Generating <span style="color: #6589bf">Human Motion</span> 
                in <span style="color: #c68b5b">3D Scenes</span><br>
                from <span style="color: #78aa58">Text Descriptions</span>
              </b>
            </h1>
            <h4 style="color:#5a6268;">CVPR 2024</h4>
            <hr>
<<<<<<< Updated upstream
            <a target="_blank">Zhi Cen<sup>1</sup></a> 
            <a href="https://phj128.github.io/" target="_blank">Huaijin Pi<sup>1</sup> </a> 
=======
            <a href="https://anitacen.github.io/">Zhi Cen<sup>1</sup></a> 
            <a href="https://phj128.github.io/">Huaijin Pi<sup>1</sup> </a> 
>>>>>>> Stashed changes
            <a href="https://pengsida.net" target="_blank">Sida Peng<sup>1*</sup> </a> 
            <a href="https://zehongs.github.io" target="_blank">Zehong Shen<sup>1</sup> </a> 
            <a target="_blank">Minghui Yang<sup>2</sup> </a> 
            <a target="_blank">Shuai Zhu<sup>2</sup> </a> 
            <a href="http://www.cad.zju.edu.cn/home/bao/" target="_blank">Hujun Bao<sup>1</sup> </a> 
            <a href="https://xzhou.me" target="_blank">Xiaowei Zhou<sup>1</sup>
            </a>
            <p>
              <sup>1</sup>Zhejiang University
              <sup>2</sup>Ant Group
              <br><sup>*</sup>Corresponding Author
            </p>
            <div class="row justify-content-center">
              <div class="column">
                <p class="mb-5">
                  <a class="btn btn-large btn-light" href="https://drive.google.com/file/d/1ZqJdvObz87CwuOlmUnYZNei54tieMZpZ/view?usp=sharing" role="button" target="_blank">
                    <i class="fa fa-file-pdf-o"></i>
                    <b>Paper</b>
                  </a>
                </p>
              </div>
              <div class="column">
                <p class="mb-5">
                  <a class="btn btn-large btn-light" href="https://drive.google.com/file/d/1yOC9QqQng-RvDQI_CMgni_HVIzSl4WU6/view?usp=sharing" role="button" target="_blank">
                    <i class="fa fa-file-pdf-o"></i>
                    <b>Supp Mat</b>
                  </a>
                </p>
              </div>
              <div class="column">
                <p class="mb-5">
                  <a class="btn btn-large btn-light" href="https://arxiv.org/abs/2405.07784" role="button" target="_blank">
                    <i class="ai ai-arxiv"></i>
                    <b>arXiv</b>
                  </a>
                </p>
              </div>
              <div class="column">
                <p class="mb-5">
                  <a class="btn btn-large btn-light" href="https://github.com/zju3dv/text_scene_motion" role="button" target="_blank">
                    <i class="fa fa-github"></i>
                    <b>Code</b>
                  </a>
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- abstract -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Abstract</h3>
          <hr style="margin-top: 0px" />
          <!-- <img src="img/overview.jpg" width="100%" /> -->
          <p class="text-left">
            Generating human motions from textual descriptions has gained growing research interest due to its wide range of applications. However, only a few works consider human-scene interactions together with text conditions, which is crucial for visual and physical realism. This paper focuses on the task of generating human motions in 3D indoor scenes given text descriptions of the human-scene interactions. This task presents challenges due to the multimodality nature of text, scene, and motion, as well as the need for spatial reasoning. To address these challenges, we propose a new approach that decomposes the complex problem into two more manageable sub-problems: (1) <strong>language grounding</strong> of the target object and (2) <strong>object-centric motion generation</strong>. For language grounding of the target object, we leverage the power of large language models. For motion generation, we design an object-centric scene representation for the generative model to focus on the target object, thereby reducing the scene complexity and facilitating the modeling of the relationship between human motions and the object. Experiments demonstrate the better motion quality of our approach compared to baselines and validate our design choices.
          </p>
        </div>
      </div>
    </div>
  </section>
  <!-- method -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Method Overview</h3>
          <hr style="margin-top: 0px" />
          <p style="text-align:center;"> 
            <img src="img/overview.jpg" width="80%"/>
          </p>
          <p>
            <strong>Overview of our two-stage pipeline.</strong> In the first stage, given an input scene and a text description (a), we use ChatGPT to locate the target object (b). In the second stage, human motions are synthesized by first producing human trajectories (c) and then generating local poses (d).
          </p>
        </div>
      </div>
    </div>
  </section>
  <!-- stage one -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Localizing the Target Object</h3>
          <hr style="margin-top: 0px" />
          <p style="text-align:center;"> 
            <img src="img/localize.jpg" width="80%"/>
          </p>
          <p>
            <strong>Pipeline of localizing the target object.</strong> In stage 1, given the input text description and detected object bounding boxes (bbx), we construct the first prompt asking ChatGPT the categories of target objects and anchor objects. Based on the response, the scene graph can be simplified. In stage 2, we construct the second prompt with inputs and results from stage 1, including object relations derived from the simplified scene graph. The second prompt is designed for asking ChatGPT to infer the target object. Finally, we can get the target object bounding box from the response of ChatGPT.
          </p>
        </div>
      </div>
    </div>
  </section>
  <!-- stage two -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Sensors for Motion Generation</h3>
          <hr style="margin-top: 0px" />
          <p style="text-align:center;"> 
            <img src="img/sensors.jpg" width="80%"/>
          </p>
          <p>
            <strong>The visualization of the sensors.</strong> The target sensor (b) gives detailed geometry of the target object. The environment sensor (c) gives coarse spatial information around the target object. The trajectory sensor (d) is located around the human.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- qual -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Qualitative Results</h3>
          <hr style="margin-top: 0px" />
        </div>
      </div>
    </div>
  </section>
  <section>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-12 text-center">
          <div class="carousel slide" data-interval="10000" data-ride="carousel" id="bkgdCarousel">
            <ol class="carousel-indicators">
              <li class="active" data-slide-to="0" data-target="#bkgdCarousel">
                <span class="indicator-dot"></span>
              </li>
              <li data-slide-to="1" data-target="#bkgdCarousel">
                <span class="indicator-dot"></span>
              </li>
              <li data-slide-to="2" data-target="#bkgdCarousel">
                <span class="indicator-dot"></span>
              </li>
              <!-- <li data-slide-to="3" data-target="#bkgdCarousel">
                <span class="indicator-dot"></span>
              </li> -->
              <!-- Additional indicators... -->
            </ol>
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Stand up from the end table that is far away from the door.</p>
                    <video width="60%" controls="controls">
                      <source src="video/qual/stand.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div>
              <div class="carousel-item">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Sit on the toilet that is farthest from the paper towel dispenser</p>
                    <video width="60%" controls="controls">
                      <source src="video/qual/sit.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div>
              <div class="carousel-item">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Walk to the bed.</p>
                    <video width="60%" controls="controls">
                      <source src="video/qual/walk.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div>
              <!-- <div class="carousel-item">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Lie on the bed.</p>
                    <video width="60%" controls="controls">
                      <source src="video/qual/lie.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div> -->
              <!-- Additional carousel items... -->
            </div>
            <a class="carousel-control-prev" data-slide="prev" href="#bkgdCarousel" role="button">
              <span aria-hidden="true" class="carousel-control-prev-icon"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" data-slide="next" href="#bkgdCarousel" role="button">
              <span aria-hidden="true" class="carousel-control-next-icon"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- generalize -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Generalization on the PROX Dataset</h3>
          <hr style="margin-top: 0px" />
          <p> Our method can work on the unseen scenes without fine-tuning. </p>
        </div>
      </div>
    </div>
  </section>
  <section>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-12 text-center">
          <div class="carousel slide" data-interval="10000" data-ride="carousel" id="bkgdCarousel1">
            <ol class="carousel-indicators">
              <li class="active" data-slide-to="0" data-target="#bkgdCarousel1">
                <span class="indicator-dot"></span>
              </li>
              <li data-slide-to="1" data-target="#bkgdCarousel1">
                <span class="indicator-dot"></span>
              </li>
              <li data-slide-to="2" data-target="#bkgdCarousel1">
                <span class="indicator-dot"></span>
              </li>
              <!-- <li data-slide-to="3" data-target="#bkgdCarousel1">
                <span class="indicator-dot"></span>
              </li> -->
              <!-- Additional indicators... -->
            </ol>
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Sit on the table that is near the shelf.</p>
                    <video width="60%" controls="controls">
                      <source src="video/prox/sit.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div>
              <div class="carousel-item">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Walk to the chair that is near the bed.</p>
                    <video width="60%" controls="controls">
                      <source src="video/prox/walk.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div>
              <div class="carousel-item">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Stand up from the armchair.</p>
                    <video width="60%" controls="controls">
                      <source src="video/prox/stand.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div>
              <!-- <div class="carousel-item">
                <div class="row sm-gutters">
                  <div class="col-md-12">
                    <p>Lie on the sofa.</p>
                    <video width="60%" controls="controls">
                      <source src="video/prox/lie.mp4" type="video/mp4">
                    </video>
                  </div>
                </div>
              </div> -->
              <!-- Additional carousel items... -->
            </div>
            <a class="carousel-control-prev" data-slide="prev" href="#bkgdCarousel1" role="button">
              <span aria-hidden="true" class="carousel-control-prev-icon"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" data-slide="next" href="#bkgdCarousel1" role="button">
              <span aria-hidden="true" class="carousel-control-next-icon"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- diverse -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h3>Diverse Results</h3>
          <hr style="margin-top: 0px" />
          <p>With the same text and scene inputs, our method can generate diverse motions.</p>
          <p style="text-align:center;">Walk to the coffee table.</p>
          <p style="text-align:center;">
          <video autoplay width="70%" controls="controls" >
            <source src="video/diverse_video.mp4" type="video/mp4">
          </video>
        </p>
        </div>
      </div>
    </div>

    <!-- Full Supp Video -->
    <section>
      <div class="container">
        <div class="row">
          <div class="col-12">
            <h3>Supplementary Video</h3>
            <hr style="margin-top: 0px" />
            <p style="text-align:center;">
            <video autoplay width="90%" controls="controls" >
              <source src="video/supplementary_video.mp4" type="video/mp4">
            </video>
          </p>
          </div>
        </div>
      </div>

  <!-- citing -->
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        </br>
        </br>
        <h3>Citation</h3>
        <hr style="margin-top: 0px" />
        <pre style="background-color: #e9eeef; padding: 1.5em 1.5em; border-radius: 20px">
<code>@inproceedings{cen2024text_scene_motion,
  title={Generating Human Motion in 3D Scenes from Text Descriptions},
  author={Cen, Zhi and Pi, Huaijin and Peng, Sida and Shen, Zehong and Yang, Minghui and Shuai, Zhu and Bao, Hujun and Zhou, Xiaowei},
  booktitle={CVPR},
  year={2024}
}</code></pre>
        <hr />
      </div>
    </div>
  </div>

  <footer class="text-center" style="margin-bottom: 10px">
    Thanks to
    <a href="https://lioryariv.github.io/" target="_blank">Lior Yariv</a>
    and <a href="https://zhenx.me/" target="_blank">Zhen Xu</a>
    for the website template.
  </footer>

  <!-- Default Statcounter code for 4K4D: Real-Time 4D View
Synthesi http://zju3dv.github.io/4k4d -->
  <script type="text/javascript">
    var sc_project = 12931644;
    var sc_invisible = 1;
    var sc_security = '012c8c76';
  </script>
  <script async src="https://www.statcounter.com/counter/counter.js" type="text/javascript"></script>
  <noscript>
    <div class="statcounter">
      <a href="https://statcounter.com/" target="_blank" title="Web Analytics
  Made Easy - Statcounter"><img alt="Web Analytics Made Easy - Statcounter" class="statcounter" referrerpolicy="no-referrer-when-downgrade" src="https://c.statcounter.com/12931644/0/012c8c76/1/" /></a>
    </div>
  </noscript>
  <!-- End of Statcounter Code -->
  <script>
    var buttonIds = [
      'mobilestage-results-button',
      'outdoor-results-button',
      'renbody-results-button',
      'n3dv-results-button',
      'nhr-results-button',
      'zjumocap-results-button',
      'mobilestage-single-results-button',

      'nhr-demos-button',
      'zjumocap-demos-button',
      'mobilestage-demos-button',
      'n3dv-demos-button',
     /* ...other button ids... */];
    var sectionIds = [
      'mobilestage-results',
      'outdoor-results',
      'renbody-results',
      'n3dv-results',
      'nhr-results',
      'zjumocap-results',
      'mobilestage-single-results',

      'nhr-demos',
      'zjumocap-demos',
      'mobilestage-demos',
      'n3dv-demos',
      /* ...other section ids... */];
    for (var i = 0; i < buttonIds.length; i++) {
      (function (index) {
        var button = document.getElementById(buttonIds[index]);
        var section = document.getElementById(sectionIds[index]);
        button.addEventListener('click', function () {
          if (section.classList.contains('show')) {
            button.innerText = 'Click to Expand';
            var videos = section.getElementsByTagName('video');
            for (var j = 0; j < videos.length; j++) {
              if (videos[j].readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
                videos[j].pause();
              }
            }
          } else {
            button.innerText = 'Click to Collapse';
            var videos = section.getElementsByTagName('video');
            for (var j = 0; j < videos.length; j++) {
              videos[j].play();
            }
          }
        });
      })(i);
    }

    var compare_button_ids = [
      'enerf-comparisons-button',
      'kplanes-comparisons-button',
     /* ...other button ids... */];
    var compare_section_ids = [
      'enerf-comparisons',
      'kplanes-comparisons',
      /* ...other section ids... */];
    for (var i = 0; i < compare_button_ids.length; i++) {
      (function (index) {
        var button = document.getElementById(compare_button_ids[index]);
        var section = document.getElementById(compare_section_ids[index]);
        button.addEventListener('click', function () {
          if (section.classList.contains('show')) {
            button.innerText = 'Click to Expand';
            var videos = section.getElementsByTagName('video');
            for (var j = 0; j < videos.length; j++) {
              if (videos[j].readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
                videos[j].pause();
              }
            }
            var merge = $(document.getElementById(compare_section_ids[index]))[0].getElementsByTagName('canvas')[0];
            if (merge.hasAttribute('animation_id')) {
              cancelAnimationFrame(merge.getAttribute('animation_id'));
            }
          } else {
            button.innerText = 'Click to Collapse';
            var videos = section.getElementsByTagName('video');
            for (var j = 0; j < videos.length; j++) {
              videos[j].play();
              // if (videos[j].readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
              // playVids(videos[j].id)
              resizeAndPlay(videos[j])
              // }
            }
          }
        });
      })(i);
    }

    document.addEventListener("DOMContentLoaded", function () {
      renderMathInElement(document.body, {
        delimiters: [
          { left: "$", right: "$", display: false },
          { left: "$$", right: "$$", display: true }
        ]
      });
    });



    function handleCarouselSlide(event) {
      // Reference to the current carousel
      var currentCarousel = $(event.target);

      // Check each video in the current carousel
      currentCarousel.find('video').each(function () {
        var isVideoInActiveItem = $(this).closest('.carousel-item').hasClass('active');
        if (isVideoInActiveItem) {
          if (this.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
            this.height = (this.videoHeight / this.videoWidth) * $(this).parent().width();
          }
          this.play();
        } else {
          if (this.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) {
            this.pause();
          }
        }
      });
    }

    $('.carousel').on('slid.bs.carousel', handleCarouselSlide);

    $(document).ready(function () {
      $('video').each(function () {
        var $video = $(this);
        var $carousel = $video.closest('.carousel');
        if ($carousel.length > 0) {
          $video.on('ended', function () {
            $carousel.carousel('next');
          });
        }
      });
    });

    function update_video_shape() {
      this.height = (this.videoHeight / this.videoWidth) * $(this).parent().width();
    }

    // fix the element's width and height properties to the current video ones
    $("video").each(function () {
      if (!this.classList.contains('comparison-video')) {
        $(this).on('loadeddata', update_video_shape);
      }
    });

    // $("#renbody-results-button").click()

    document.addEventListener("DOMContentLoaded", function () {
      // Get all videos
      var videos = document.querySelectorAll('video');

      // Add source to video tag
      function addSourceToVideo(element, src) {
        var source = document.createElement('source');
        source.src = src;
        source.type = 'video/mp4';
        element.appendChild(source);
      }

      // Determine screen size and select appropriate videos
      function whichSizeVideo(element) {
        var windowWidth = window.innerWidth || window.innerWidth;
        var prefix = windowWidth > 1200 ? "desktop" : "mobile";

        // Get all data attributes for the given prefix (e.g., data-mobile-vid1, data-mobile-vid2, ...)
        var i = 1;
        while (element.dataset[prefix + "Vid" + i]) {
          addSourceToVideo(element, element.dataset[prefix + "Vid" + i]);
          i++;
        }
      }

      // Initialize only if the page has videos
      function videoSize() {
        if (videos) {
          videos.forEach(whichSizeVideo);
        }
      }

      videoSize();

      setInterval(function () {
        // 选择所有comparison-video类型的视频
        let videos = document.querySelectorAll('.comparison-video');

        videos.forEach(video => {
          // 如果id没有以After结尾
          if (!video.id.endsWith('After')) {
            resizeAndPlay(video);
          }
        });
      }, 10000);  // 每500毫秒检测一次

    });
  </script>
</body>

</html>
